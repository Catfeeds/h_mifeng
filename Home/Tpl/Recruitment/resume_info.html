<include file='Public:pageHeader'/>
<body data-psd-width="750" class="f3f3f3">
  <div class="Join_form">
    <form method="post" action="{:U('Recruitment/resume_save')}" id="submitForm" name="submitForm" enctype="multipart/form-data">
      <div class="jo_box" id="jo_box1">
        <div class="input clearfix">
          <span class="span">姓名<font class="red2">*</font></span>
          <input type="text" name="name" placeholder="姓名" value="{$info.name}" datatype="*" errormsg="请填写姓名" nullmsg="请填写姓名"/>
        </div>
        <div class="input clearfix">
          <span class="span">年龄<font class="red2">*</font></span>
          <input type="text" name="age" placeholder="年龄" value="{$info.age}" datatype="*" errormsg="请填写年龄" nullmsg="请填写年龄"/>
        </div>
        <div class="input clearfix">
          <span class="span">身高</span>
          <input type="text" name="height" placeholder="身高" value="{$info.height}" />
        </div>
        <div class="input clearfix">
          <span class="span">婚姻状况</span>
          <!-- <input type="text" name="marriage" placeholder="婚姻状况" value="{$info.marriage}"/> -->
          <select name="marriage" datatype="*" errormsg="请填写婚姻状况" nullmsg="请填写婚姻状况">
            <option value="未婚" <if condition="$info['marriage'] eq '未婚' "> selected="selected"</if>>未婚</option>
            <option value="已婚" <if condition="$info['marriage'] eq '已婚' "> selected="selected"</if>>已婚</option>
          </select>
        </div>
        <div class="input clearfix">
          <span class="span">手机<font class="red2">*</font></span>
          <input type="text" name="phone" placeholder="手机" value="{$info.phone}"  datatype="*,m" errormsg="请填写手机" nullmsg="请填写手机"/>
        </div>
        <div class="input clearfix">
          <span class="span">邮箱<font class="red2">*</font></span>
          <input type="text" name="email" placeholder="邮箱" value="{$info.email}" datatype="*,e" errormsg="请填写邮箱" nullmsg="请填写邮箱"/>
        </div>
        <div class="input clearfix">
          <span class="span">期望职位<font class="red2">*</font></span>
          <input type="text" name="position" placeholder="期望职位" value="{$info.position}" datatype="*" errormsg="请填写期望职位" nullmsg="请填写期望职位"/>
        </div>
        <if condition="count($info['province']) gt 0">
          <foreach name="info.province" item="item" key="k">
            <div class="input clearfix regin" data-on="{$k}">
              <span class="span">工作地点<font class="red2">*</font></span>
              <span class="text"  id="regin{$k}" ><if condition="!empty($info['province_name'][$k]) OR !empty($info['city_name'][$k]) OR !empty($info['district_name'][$k])">{$info['province_name'][$k]} {$info['city_name'][$k]}<else/>请选择</if></span>
              <input type="hidden" name="province[]"  value="{$info.province.$k}" datatype="*" errormsg="请填写工作地点" nullmsg="请填写工作地点">
              <input type="hidden" name="city[]"  value="{$info.city.$k}" datatype="*" errormsg="请填写工作地点" nullmsg="请填写工作地点">
              <if condition="$k eq 0">
                <i class="ace-icon fa fa-plus bigger-110"></i>
              <else/>
                <i class="ace-icon fa fa-minus bigger-110"></i>
              </if>
            </div>
          </foreach>
        <else/>
        <div class="input clearfix regin" data-on="0">
          <span class="span">工作地点<font class="red2">*</font></span>
          <span class="text"  id="regin0" ><if condition="!empty($info['province_name']) OR !empty($info['city_name']) OR !empty($info['district_name'])">{$info['province_name']} {$info['city_name']}<else/>请选择</if></span>
          <input type="hidden" name="province[]"  value="" datatype="*" errormsg="请填写工作地点" nullmsg="请填写工作地点">
          <input type="hidden" name="city[]"  value="" datatype="*" errormsg="请填写工作地点" nullmsg="请填写工作地点">
          <i class="ace-icon fa fa-plus bigger-110"></i>
        </div>
        </if>
      </div>
      <div class="jo_box">
        <div class="input clearfix">
          <span class="span">学历<font class="red2">*</font></span>
          <!-- <input type="text" name="education" placeholder="学历" value="{$info.education}"/> -->
          <select name="education" datatype="*" errormsg="请填写学历" nullmsg="请填写学历">
            <option value="高中以下" <if condition="$info['education'] eq '高中以下' "> selected="selected"</if>>高中以下</option>
            <option value="高中" <if condition="$info['education'] eq '高中' "> selected="selected"</if>>高中</option>
            <option value="中专/技校" <if condition="$info['education'] eq '中专/技校' "> selected="selected"</if>>中专/技校</option>
            <option value="大专" <if condition="$info['education'] eq '大专' "> selected="selected"</if>>大专</option>
            <option value="本科" <if condition="$info['education'] eq '本科' "> selected="selected"</if>>本科</option>
            <option value="硕士" <if condition="$info['education'] eq '硕士' "> selected="selected"</if>>硕士</option>
            <option value="博士" <if condition="$info['education'] eq '博士' "> selected="selected"</if>>博士</option>
          </select>
        </div>
        <div class="input clearfix">
          <span class="span">专业<font class="red2">*</font></span>
          <input type="text" name="profession" placeholder="专业" value="{$info.profession}" datatype="*" errormsg="请填写专业" nullmsg="请填写专业"/>
        </div>
        <div class="input clearfix">
          <span class="span">工作年龄<font class="red2">*</font></span>
          <!-- <input type="text" name="working_age" placeholder="工作年龄" value="{$info.working_age}"/> -->
          <select name="working_age" datatype="*" errormsg="请填写工作年龄" nullmsg="请填写工作年龄">
            <option value="无经验" <if condition="$info['working_age'] eq '无经验' "> selected="selected"</if>>无经验</option>
            <option value="应届生" <if condition="$info['working_age'] eq '应届生' "> selected="selected"</if>>应届生</option>
            <option value="1年以下" <if condition="$info['working_age'] eq '1年以下' "> selected="selected"</if>>1年以下</option>
            <option value="1-2年" <if condition="$info['working_age'] eq '1-2年' "> selected="selected"</if>>1-2年</option>
            <option value="3-5年" <if condition="$info['working_age'] eq '3-5年' "> selected="selected"</if>>3-5年</option>
            <option value="6-10年" <if condition="$info['working_age'] eq '6-10年' "> selected="selected"</if>>6-10年</option>
            <option value="10年以上" <if condition="$info['working_age'] eq '10年以上' "> selected="selected"</if>>10年以上</option>
          </select>
        </div>
      </div>
      <div class="jo_box">
        <div class="input clearfix">
          <span class="span">工作经验<font class="red2">*</font></span>
          <textarea rows="3" name="experience" placeholder="工作经验" datatype="*" errormsg="请填写工作经验" nullmsg="请填写工作经验">{$info.experience}</textarea>
        </div>
        <div class="input clearfix">
          <span class="span">教育信息<font class="red2">*</font></span>
          <textarea rows="3" name="education_information" placeholder="教育信息" datatype="*" errormsg="请填写教育信息" nullmsg="请填写教育信息">{$info.education_information}</textarea>
        </div>
        <div class="input clearfix">
          <span class="span">技能专长<font class="red2">*</font></span>
          <textarea rows="3" name="talent" placeholder="技能专长" datatype="*" errormsg="请填写技能专长" nullmsg="请填写技能专长">{$info.talent}</textarea>
        </div>
        <div class="input clearfix">
          <span class="span">自我评价<font class="red2">*</font></span>
          <textarea rows="3" name="self_evaluation" placeholder="自我评价" datatype="*" errormsg="请填写自我评价" nullmsg="请填写自我评价">{$info.self_evaluation}</textarea>
        </div>
        <div class="input clearfix">
          <span class="span">相关资质</span>
          <div class="fr " id="file_box"><foreach name="info.ResumeImg" item="item"><span style="background-image: url(/{$item.thumb_img});"> <i></i> <input type="file" name="file[]" class="file"><input type="hidden" name="file_id[]" value="{$item.id}"></span></foreach><span class="re_more"></span></div>
        </div>
      </div>
      <div class="jo_box">
        <div class="input clearfix">
          <span class="span">是否求职</span>
          <em class="switch <if condition="$info['is_open'] eq 1">on</if>">
            <input type="checkbox" name="is_open" value="1" <if condition="$info['is_open'] eq 1">checked="checked"</if> />
            <i></i>
          </em>
        </div>
      </div>
      <div class="ybm_submit">
        <input type="submit" value="确认保存" />
      </div>
      <div class="ybm_checkbox">
        <label for="gg_1">
          <input type="checkbox" name="protocol" value="1" checked="checked" datatype="*" errormsg="请同意协议" nullmsg="请同意协议"/>
          <span>已阅读并同意</span>
        </label>
        <a class="xieyi">《{$xieyi_list.255.title}》</a>
      </div>
    </form>
  </div>
  <div class="xieyi_bg"></div>
  <div class="xieyi_fix">
    <h3>{$xieyi_list.255.title}</h3>
    {$xieyi_list.255.content}
  </div>
  <include file='Public:page_nav'/>
</body>
<include file='Public:pageFooter'/>
<link rel="stylesheet" type="text/css" href="__CSS__/mobileSelect.css">
<script src="__JS__/mobileSelect.min.js" type="text/javascript"></script>
<script>
  $(document).ready(function() {
    $('.re_more').on('click',function(){
      var html = '<span> <i></i> <input type="file" name="file[]" class="file"><input type="hidden" name="file_id[]" value="0"> </span>';
      $('#file_box .re_more').before(html);
    })
    $('#file_box').on('click',"span i",function(){
      $(this).parents("span").remove();
    })
    $("#file_box").on("change",".file",function(){
      var _this = $(this);
      var reader = new FileReader();
      reader.onload = function (e) {
        _this.parent("span").addClass("img");
        _this.parent("span").css("background-image","url("+e.target.result+")");
        _this.siblings("input[name='file_id[]']").val(0);
      };
      reader.readAsDataURL(this.files[0]);
    })


    $("#submitForm").Validform({
      tipSweep:true,
      tiptype:function(msg,o){
        if(o.type==3){
          layer.open({
            content: msg
            ,skin: 'msg'
            ,time: 2
          });
        }
      },
    });
    var region_all = {$region_all};
    
    $("#jo_box1").on("click",".regin .fa-minus",function(){
      $("this").parents(".regin").remove();
    })
    $("#jo_box1").on("click",".regin .fa-plus",function(){
      var id_on = $(".regin").last().attr("data-on");
      id_on++;
      if($("#jo_box1").find(".regin").length>2){
        layer.open({
          content: "工作地点最多3个"
          ,skin: 'msg'
          ,time: 2
        });
        return false;
      }
      var html = '<div class="input clearfix regin" data-on="'+id_on+'"> <span class="span">工作地点<font class="red2">*</font></span> <span class="text" id="regin'+id_on+'" >请选择</span> <input type="hidden" name="province[]"  value=""> <input type="hidden" name="city[]"  value=""> <i class="ace-icon fa fa-minus bigger-110"></i></div>';
      $("#jo_box1").append(html);
      var mobileSelect2 = new MobileSelect({
          trigger: '#regin'+id_on,
          title: '地区',
          triggerDisplayData:true,
          wheels:[{data:region_all},],
              keyMap: {
                id:'region_id',
                value: 'region_name',
                childs :'child'
            }, 
          transitionEnd:function(indexArr, data){
              // console.log(data);
          },
          callback:function(indexArr, data){
            $(this.trigger).siblings("input[name='province[]']").val(data['0'].region_id);
            $(this.trigger).siblings("input[name='city[]']").val(data['1'].region_id);
          }
      });
    })
    <if condition="count($info['province']) gt 0">
      <foreach name="info.province" item="item" key="k">
        var mobileSelect2 = new MobileSelect({
            trigger: '#regin{$k}',
            title: '地区',
            triggerDisplayData:true,
            wheels:[{data:region_all},],
                keyMap: {
                  id:'region_id',
                  value: 'region_name',
                  childs :'child'
              }, 
            transitionEnd:function(indexArr, data){
                // console.log(data);
            },
            callback:function(indexArr, data){
              $(this.trigger).siblings("input[name='province[]']").val(data['0'].region_id);
              $(this.trigger).siblings("input[name='city[]']").val(data['1'].region_id);
            }
        });
      </foreach>
    <else/>
      var mobileSelect2 = new MobileSelect({
          trigger: '#regin0',
          title: '地区',
          triggerDisplayData:true,
          wheels:[{data:region_all},],
              keyMap: {
                id:'region_id',
                value: 'region_name',
                childs :'child'
            }, 
          transitionEnd:function(indexArr, data){
              // console.log(data);
          },
          callback:function(indexArr, data){
            $(this.trigger).siblings("input[name='province[]']").val(data['0'].region_id);
            $(this.trigger).siblings("input[name='city[]']").val(data['1'].region_id);
          }
      });
    </if>
    
    $(".Join_form").on("change",".file",function(){
      var _this = $(this);
      var val = _this.val();
      var reader = new FileReader();
      if(!/\.(gif|jpg|jpeg|png|GIF|JPG|PNG|GIF|doc|DOC|docx|DOCX)$/.test(val)){
        layer.open({
          content: "简历类型必须是gif,jpg,png,do简历中的一种"
          ,skin: 'msg'
          ,time: 2
        });
        return false;
      }
      reader.onload = function (e) {
        // _this.parent(".img").css("background-image","url("+e.target.result+")");
        layer.open({
          content: "上传成功"
          ,skin: 'msg'
          ,time: 2
        });
      };
      reader.readAsDataURL(this.files[0]);
    })

    $('.switch').on('click',function(){
      if($(this).hasClass('on')){
        $(this).removeClass('on');
        $(this).find('input').attr('checked',false);
      }else{
        $(this).addClass('on');
        $(this).find('input').attr('checked',true);
      }
    });
  });
</script>